\documentclass[11pt]{article}
\usepackage[margin=2cm,a4paper]{geometry}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{authblk}
%\usepackage[superscript,biblabel]{cite}
\usepackage[super]{natbib}

\usepackage[outdir=./img/]{epstopdf}
\usepackage{epsfig}
\usepackage{url}
% Places figures at end of document, and do not print out the figures
\usepackage[nomarkers,nolists,tablesfirst]{endfloat}
\renewcommand{\includegraphics}[2][]{}

\usepackage{xr}
\externaldocument{supplement}

\usepackage{tikz}
\usetikzlibrary{fit,positioning}
\usetikzlibrary{arrows}

\setlength\parindent{0pt}

\input{./title.tex}

\begin{document}

\maketitle


\begin{abstract}

\end{abstract}

\section*{Introduction}
  Pathway analysis is a growing area of research, made more available by advances in computational power and databases. The greatest advantage of pathway analysis is that it lets us consider biological processes as units rather than each individual gene or protein by themselves.

\subsection{Pathway analysis}
  Pathway analysis is a relatively new concept in biology, made popular in the mid 2000s. Thanks to advancements in computer hardware, high throughput methods such as pathway analysis have been made possible.

  The value of pathway analysis is the fact that you can look specifically at different cellular mechanisms as a unit instead of just the genes or proteins individually. Using the reactome database \cite{reactome}, you can also look at the pathway hierarchy to define subprocesses of particular mechanisms.

  A common issue in biology is the observation that nothing occurs in isolation, for example, estrogen binding to a receptor does not just cause a conformational change in the receptor, but also leads to a plethora of secondary actions, all dependent on each other. To account for this potential Whac-a-mole when influencing a specific target it is a good idea to look at the target in its pathway context.

  Using clusters generated by metabric from the iCluster platform using cis-acting genes that exhibit significant associations with CNAs \cite{metabric} as well as common subtypes, this thesis describes a new method of looking at pathway analysis.

\subsection{Sunburst plotting}
  A common practice in pathway analysis is tabularly present results. While this does outline the most interesting pathways a lot of information is lost to truncation. Furthermore, tabular presentations of pathway analysis seldomly characterize the hierarchical relationships of the pathways and even less so in a comprehensive manner.

  Sunburst plotting complemented by a tabular view of the most interesting pathways gives a better understanding of the cell. It incorporates hierarchial relationships as well as the complete picture of the cell landscape.



\section*{Methods}
  The data from ((((dataset)))) was compared using gsea.
  The resulting data were compiled into a hierarchical json file which was subsequently displayed as a sunburst plot.

  The sunburst display also took the data from the json file and displayed the 50 pathways with the lowest fdr in a table to show where the most interesting data was.

  \begin{figure}[t]
    \centering
    \tikzstyle{start} = [rectangle, rounded corners, minimum width=3cm, text width=12cm, minimum height=1.7cm, text centered, draw=black, fill=red!10]
    \tikzstyle{JSON} = [rectangle, rounded corners, minimum width=3cm, text width=12cm, minimum height=1.7cm, text centered, draw=black, fill=red!20]
    \tikzstyle{sunburst} = [rectangle, rounded corners, minimum width=3cm, text width=12cm, minimum height=1.7cm, text centered, draw=black, fill=red!30]
    \tikzstyle{arrow} = [thick, ->, >=stealth]

    \begin{tikzpicture}
    \node (start) [start] {GSEA comparison between groups};
    \node (JSON) [JSON, below of=Failures of null, yshift=-1.2cm] {Generate hiererchical data structure including pathway information for sunburst plotting};
    \node (sunburst) [sunburst, below of=JSON, yshift=-1.2cm] {Sunburst plotting};

    \draw [arrow] (start) -- (JSON);
    \draw [arrow] (JSON) -- (sunburst);

    \end{tikzpicture}
  \caption{ A flowchart representation of the pipeline developed for this article.}
  \label{Pipeline flowchart}
\end{figure}

\subsection*{Datasets}
  \url{https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE132802}
\subsection*{Code availability}
  Code is available at \url{https://github.com/statisticalbiotechnology/porch}

\section*{Results}


  As there are many pathways, and the choice was to size the cells according to pathway size, some pathways are difficult to see. The table thus acts as a guide to find interesting pathways.


\begin{figure}[htp]
\begin{center}
%\includegraphics[width=0.96\linewidth,clip]{./img/id-stats-feature-groups-subset}
\caption{\label{fig:id-stats} {\bf Title.} Description.}
\end{center}
\end{figure}

\section*{Discussion}
  One of the greatest advantages of sunburst plotting is the possibility to view all cellular pathways simultaneously in their hierarchical context. Tabular views generally only gives a glimpse of the most interesting pathways while neglecting the bulk of pathways.

  Sunburst plotting as a complement to a tabular view gives a more holistic view of pathway activities in the cell.

  One great feature of sunburst plots is the possibility to see parent-child pathway relationships. As seen in fig  ((((((image of "line" of parent child significant pathways)))))) parent pathway X and child pathway Y are both significantly different between groups whilst child pathway Z is not.


  Another advantage of sunburst plotting is the speed to which a primary conclusion can be made of where the focal points of the experiment lie. While tables might give a similar conclusion, a significant amount of time will have to be spent to reach it.

  Sunburst plotting together with the tabular analysis described above became an excellent combination of analyses as the table provides very specific information of the pathways and the sunburst plots provide a broader picture of the pathway relationships of cells.

  One aspect where the advantage of using sunburst plotting became undeniable was when analysing parent child pathway relationships. As can be seen in figure X, the activity of Y (white) differs from the activity of Z (red). This thus becomes somewhat of a barcoding analysis where a straight line of parent child pathways with low q-value is quite convincing evidence against type I errors.

  Seeing as this is a relatively novel method of analysis, a few points of benchmarking and what the underlying biology might be have been developed.

  \begin{itemize}
      \item A parent pathway with relatively medium q-value and several child-pathways where at least one of them has very low q-value is a good indicator that the parent pathway q-value might be affected by a change in the significant child pathway.
      \item A significant pathway with no children should be an interesting pathway to study as it has been broken down as much as possible and still poses a significant difference in activity compared to other clusters.
      \item A significant parent pathway with children that all have $q > 0.001 $ need to be examined further as neither of the subprocesses have been deemed significant. 
    \end{itemize}

\section*{Acknowledgments}

This work was supported by a grant from the Swedish Research Council (grant
2017-04030).

\section*{Author Contributions}

\section*{Competing interests}

The authors declare that they have no conflict of interest.

\end{document}
